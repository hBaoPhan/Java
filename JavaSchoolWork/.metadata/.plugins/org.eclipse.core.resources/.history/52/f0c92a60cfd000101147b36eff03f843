package dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;

import connectDB.ConnectDB;
import entity.NhanVien;
import gui.PhongBan;

public class PhongBan_DAO {
	public ArrayList<PhongBan> getAllPhongBan() {
		ConnectDB.getInstance();
		Connection con=ConnectDB.getCon();
		PreparedStatement stmt=null;
		ArrayList<NhanVien> ds= new ArrayList<NhanVien>();
		String sql="Select * From NhanVien";
		try {
			stmt=con.prepareStatement(sql);
			ResultSet rs=stmt.executeQuery();
			while (rs.next()) {
				String ma=rs.getString(1);
				String ho=rs.getString(2);
				String ten=rs.getString(3);
				int tuoi=rs.getInt(4);
				boolean phai=rs.getBoolean(5);
				PhongBan pb=new PhongBan(rs.getString(6));
				double luong=rs.getDouble(7);
				ds.add(new NhanVien(ma, ho, ten, tuoi, phai, pb, luong));
				
			}
		} catch (Exception e) {
			// TODO: handle exception
		}
		return ds;
	}

}
