package dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;

import connectDB.ConnectDB;
import entity.NhanVien;
import gui.PhongBan;

public class NhanVien_DAO {
	public ArrayList<NhanVien> getAll() {
		ConnectDB.getInstance();
		Connection con=ConnectDB.getCon();
		PreparedStatement stmt=null;
		ArrayList<NhanVien> ds= new ArrayList<NhanVien>();
		String sql="Select * From NhanVien";
		try {
			stmt=con.prepareStatement(sql);
			ResultSet rs=stmt.executeQuery();
			while (rs.next()) {
				String ma=rs.getString(1);
				String ho=rs.getString(2);
				String ten=rs.getString(3);
				int tuoi=rs.getInt(4);
				boolean phai=rs.getBoolean(5);
				PhongBan pb=new PhongBan(rs.getString(6));
				double luong=rs.getDouble(7);
				ds.add(new NhanVien(ma, ho, ten, tuoi, phai, pb, luong));
				
			}
		} catch (Exception e) {
			// TODO: handle exception
		}
		return ds;
	}
	public boolean them(NhanVien nv) {
		ConnectDB.getInstance();
		Connection con=ConnectDB.getCon();
		PreparedStatement stmt=null;
		String sql="Insert Into NhanVien Values (?,?,?,?,?,?,?)";
		int n=0;
		try {
			stmt=con.prepareStatement(sql);
			stmt.setString(1, nv.getMa());
			stmt.setString(2, nv.getHo());
			stmt.setString(3, nv.getTen());
			stmt.setInt(4, nv.getTuoi());
			stmt.setBoolean(5, nv.isPhai());
			stmt.setString(6, nv.getPhongBan().getMa());
			stmt.setDouble(7, nv.getTienLuong());
			n=stmt.executeUpdate();
			return n>0;
		} catch (Exception e) {
			// TODO: handle exception
		}
		return false;
	}
	public boolean xoa(String ma) {
		ConnectDB.getInstance();
		Connection con=ConnectDB.getCon();
		PreparedStatement stmt=null;
		String sql="Delete From NhanVien Where maNV = ?";
		int n=0;
		try {
			stmt=con.prepareStatement(sql);
			stmt.setString(1, ma);
			
			return n>0;
		} catch (Exception e) {
			// TODO: handle exception
		}
		return false;
	}
	public ArrayList<NhanVien> timTheoMa(String maNV) {
		ConnectDB.getInstance();
		Connection con=ConnectDB.getCon();
		PreparedStatement stmt=null;
		ArrayList<NhanVien> ds= new ArrayList<NhanVien>();
		String sql="Select * From NhanVien Where maNV=?";
		try {
			stmt=con.prepareStatement(sql);
			stmt.setString(1, maNV);
			ResultSet rs=stmt.executeQuery();
			while (rs.next()) {
				String ma=rs.getString(1);
				String ho=rs.getString(2);
				String ten=rs.getString(3);
				int tuoi=rs.getInt(4);
				boolean phai=rs.getBoolean(5);
				PhongBan pb=new PhongBan(rs.getString(6));
				double luong=rs.getDouble(7);
				ds.add(new NhanVien(ma, ho, ten, tuoi, phai, pb, luong));
				
			}
		} catch (Exception e) {
			// TODO: handle exception
		}
		return ds;
	}

}
